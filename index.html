<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Danh sách sách</title>
  <style>
    .hidden 
    {
      display: none;
    }
    .book 
    {
      margin: 20px;
      padding: 10px;
      background-color: #eee;
      cursor: pointer;
    }
    #morse 
    {
       white-space: pre-wrap; /* tự xuống dòng khi quá dài */
       word-break: break-word; /* ngắt từ khi cần */
    }
  </style>
</head>
<body>

  <!-- Trang chủ: Danh sách sách -->
  <div id="home">
    <h1>Danh sách sách giáo khoa</h1>
    <div class="book" onclick="showDetail('toan')">Sách Toán</div>
    <div class="book" onclick="showDetail('van')">Sách Văn</div>
  </div>

  <!-- Trang chi tiết -->
  <div id="detail" class="hidden">
    <h2 id="bookTitle"></h2>
    <p id="bookInfo"></p>
    <pre id="morse"></pre>
    <button onclick="goHome()">Quay lại</button>
  </div>

  <script>
    const morseMap = {
      A: '.-', B: '-...', C: '-.-.', D: '-..', E: '.', F: '..-.',
      G: '--.', H: '....', I: '..', J: '.---', K: '-.-', L: '.-..',
      M: '--', N: '-.', O: '---', P: '.--.', Q: '--.-', R: '.-.',
      S: '...', T: '-', U: '..-', V: '...-', W: '.--', X: '-..-',
      Y: '-.--', Z: '--..',
      0: '-----', 1: '.----', 2: '..---', 3: '...--',
      4: '....-', 5: '.....', 6: '-....', 7: '--...', 8: '---..', 9: '----.',
      ' ': '/'
    };
    function normalizeVietnamese(text) 
    {
     return text
    .normalize('NFD')                        // tách các ký tự dấu ra
    .replace(/[\u0300-\u036f]/g, '')        // loại bỏ các ký tự dấu
    .replace(/đ/g, 'd')
    .replace(/Đ/g, 'D');
    }

    function textToMorse(text) 
    {
      return text.toUpperCase().split('').map(char => morseMap[char] || '').join(' ');
    }

    async function showDetail(book) {
      document.getElementById("home").classList.add("hidden");
      document.getElementById("detail").classList.remove("hidden");

      if (book === 'toan') {
        document.getElementById("bookTitle").innerText = "Sách Toán lớp 9";
        try {
          const response = await fetch('data/mytext.txt');
          const text = await response.text();
          document.getElementById("bookInfo").innerText = text;
          const cleanText = normalizeVietnamese(text);
          document.getElementById("morse").innerText = textToMorse(cleanText);
        } catch (error) {
          document.getElementById("bookInfo").innerText = "Không tải được nội dung sách Toán.";
          document.getElementById("morse").innerText = "";
          console.error('Lỗi khi fetch:', error);
        }
      }

      if (book === 'van') {
        document.getElementById("bookTitle").innerText = "Sách Ngữ Văn lớp 9";
        const text = "Gồm thơ, truyện ngắn, và nghị luận...";
        document.getElementById("bookInfo").innerText = text;
        const cleanText = normalizeVietnamese(text);
        document.getElementById("morse").innerText = textToMorse(cleanText);
      }
    }

    function goHome() 
    {
      document.getElementById("home").classList.remove("hidden");
      document.getElementById("detail").classList.add("hidden");
    }
  </script>

</body>
</html>

</body>
</html>
